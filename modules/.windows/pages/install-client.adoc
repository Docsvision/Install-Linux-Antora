= Установка клиентских компонентов модулей

Для работы с системой {dv} пользователи (клиенты) могут использовать {wincl}, установленный на компьютеры.

.{wincl} может быть установлен двумя способами:
* <<fromServer,С сервера {dv}>> -- требуемые компоненты будут загружены с сервера {dv} и установлены автоматически.
* <<fromMsi,Из пакета установки (вручную)>> -- администратор должен самостоятельно установить клиентские части модулей {pl} и {wincl}, остальные базовые модули будут установлены автоматически.

Клиентские компоненты модулей могут быть установлены для текущего пользователя или для всех пользователей компьютера.

.Область установки выбирается:
* С помощью настройки menu:{cns}[Настройки сервера > Настройка клиентской части > Область установки] -- если компоненты устанавливаются <<fromServer,с сервера>> {dv}.
* При установке клиентской части модуля {pl} -- если компоненты устанавливаются <<fromMsi,вручную>>.

[#fromServer]
== Установка {wincl}а с сервера {dv}

. Откройте Internet Explorer на компьютере пользователя (Microsoft Edge режиме совместимости с IE).
+
****
Если в программе _{cns}_ для установки клиентской части указана область установки _Для всех пользователей_, Internet Explorer (Microsoft Edge режиме совместимости с IE) нужно запустить с правами администратора компьютера.
****
+
. Настройте веб-браузер.
+
.Microsoft Edge:
****
.. Откройте страницу настроек `edge://settings/defaultBrowser`
.. Разрешите сайтам перезагрузку в режиме Internet Explorer
.. Добавьте в _Список страниц в режиме Internet Explorer_ страницу `\http://server-name/имя-виртуальной-папки-Docsvision-в-IIS/StartPage.aspx`.
****
+
.Internet Explorer:
****
.. Добавьте адрес сервера {dv} в _Надежные сайты_.
.. Для зоны надежных сайтов настройте конфигурацию:
+
* menu:Проверка подлинности пользователя[Вход > Автоматический вход в сеть с текущим именем пользователя и паролем].
* menu:Элементы ActiveX и модули подключения[Использование элементов управления ActiveX, не помеченных как безопасные для использования > Включить].
* menu:Элементы ActiveX и модули подключения[Разрешить запуск элементов управления ActiveX, которые не использовались ранее, без предупреждения > Включить]
* menu:Элементы ActiveX и модули подключения[Запуск элементов ActiveX и модулей подключения > Включить].
.. В Internet Explorer версии 11 включите режим совместимости для адреса сервера {dv}, чтобы избежать ошибок.
+
Откройте menu:Сервис[Параметры просмотра в режиме совместимости] и добавьте адрес сервера {dv} в список сайтов с режимом совместимости.
****
+
. В Internet Explorer (Microsoft Edge режиме совместимости с IE) перейдите на стартовую страницу {dv} вида: `\http://server-name/dv-virtual-folder-name/StartPage.aspx`, где `dv-virtual-folder-name` -- имя виртуальной папки {dv} в IIS.
+
****
Будут установлены клиентские части модулей {pl} и {wincl} с областью установки, указанной в Консоли настройки {dv}.

[NOTE]
====
Если установка не начнется автоматически, нажмите на ссылку с текстом `здесь`.
====
****
+
. После завершения установки на рабочий стол и в меню Пуск будут добавлены ярлыки для запуска {wincl}а и РМА.
+
. Запустите {wincl}. При подключении к серверу {dv} будет выполнена установка клиентских частей других базовых модулей, серверные части которых установлены на сервере {dv}.
+
NOTE: Если в программе _{cns}_ выбрана область установки клиентских компонентов _Для всех пользователей_, {wincl} должен быть запущен с правами администратора компьютера.

[#fromMsi]
== Установка {wincl}а из установочного пакета

. Запустите мастер установки клиентской части модуля {pl}, открыв `{dv} Platform client.msi`. Нажмите *Далее*.
. Примите условия лицензионного соглашения для продолжения установки и нажмите *Далее*.
. Выберите область установки модуля: _Для текущего пользователя_ или _Для всех пользователей_.
+
****
.Выбор области установки
image::ROOT:install-scope.png[Выбор области установки]

Установить модуль для всех пользователей можно из командной строки, используя параметр `ALLUSERS` пакета установки: `msiexec /i {dv} Platform client.msi ALLUSERS=1`.

Если на компьютере уже установлена серверная часть модуля {pl}, любой модуль всегда будет устанавливаться _Для всех пользователей_. В данном случае, а также в случае запуска пакета установки с параметром `ALLUSERS=1`, страница выбора области установки будет пропущена.
****
+
. Будет открыто окно выбора каталога установки модуля {pl}. Если требуется, измените каталог установки. Нажмите *Далее*.
. Чтобы начать установку, нажмите *Установить*. Дождитесь завершения установки.
. Нажмите кнопку *Готово*, чтобы завершить установку.
. Установите клиентскую часть модуля {wincl}, из пакета установки `{dv} WindowsClient.msi`. Для продолжения нажмите *Далее*.
+
WARNING: Если клиентская часть модуля {pl} установлена для всех пользователей, для установки {wincl}а потребуются права администратора.
+
. Примите условия лицензионного соглашения, нажмите *Далее*.
. Выберите дополнительные компоненты для установки и нажмите *Далее*.
+
NOTE: Можно отключить установку компонента Интеграция с Google Chrome, если не требуется возможность открытия ссылок на карточки {dv} с помощью веб-браузера Google Chrome.
+
. В появившемся окне введите адреса сервера {dv}. Введите адрес в формате `\http://имя-сервера-{dv}]/имя-виртуальной-папки {dv}` и нажмите *Далее*.
+
.Адрес подключения к серверу {dv}
image::ROOT:install-server-url.png[Адрес подключения к серверу {dv}]
+
. Чтобы начать установку, нажмите *Установить*. Дождитесь завершения установки.
. Нажмите кнопку *Готово*, чтобы завершить установку.
+
****
На рабочем столе и в меню Пуск будут размещены ярлыки для запуска {wincl}а и РМА.
****
+
. Установите клиентские части оставшихся базовых модулей одним из двух способов:
* Запустите {wincl}. Когда {wincl} подключится к серверу {dv}, будут установлены клиентские части базовых модулей, которые уже установлены на сервере {dv}.
+
WARNING: Если в программе _{cns}_ выбрана область установки клиентских компонентов _Для всех пользователей_, {wincl} должен быть запущен с правами администратора.
+
* Аналогично установке клиентской части модуля {wincl} установите клиентские части модулей из пакетов установки:
** `{dv} BackOffice client.msi` -- _{bo}_.
** `{dv} Workflow client.msi` -- _{wf}_.
** `{dv} DocumentManagement client.msi` -- _{dm}_.
** `{dv} ApprovalDesigner client.msi` -- _{ad}_.
** `{dv} TakeOffice client.msi` -- _{to}_.
** `{dv} Worker service client.msi` -- _Служба {ws}_.
+
[NOTE]
====
Чтобы избежать ошибок, всегда устанавливайте клиентскую часть модуля _{to}_ после модуля {wincl}.
====
